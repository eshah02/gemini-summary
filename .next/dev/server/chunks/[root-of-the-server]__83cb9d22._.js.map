{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Homol/todo-app-mongo/lib/mongodb.js"],"sourcesContent":["import { MongoClient } from \"mongodb\";\r\n\r\nconst uri = process.env.MONGODB_URI;\r\n\r\nif (!uri) throw new Error(\"‚ùå Missing MONGODB_URI in .env.local\");\r\n\r\nlet client;\r\nlet clientPromise;\r\n\r\nif (process.env.NODE_ENV === \"development\") {\r\n  if (!global._mongoClientPromise) {\r\n    client = new MongoClient(uri);\r\n    global._mongoClientPromise = client.connect();\r\n  }\r\n  clientPromise = global._mongoClientPromise;\r\n} else {\r\n  client = new MongoClient(uri);\r\n  clientPromise = client.connect();\r\n}\r\n\r\nexport default clientPromise;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AAEnC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;AAE1B,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,IAAI,CAAC,yDAAO,mBAAmB,EAAE;QAC/B,SAAS,IAAI,sHAAW,CAAC;QACzB,yDAAO,mBAAmB,GAAG,OAAO,OAAO;IAC7C;IACA,gBAAgB,yDAAO,mBAAmB;AAC5C;;uCAKe"}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Homol/todo-app-mongo/app/api/tasks/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport clientPromise from \"../../../lib/mongodb\";\r\nimport { ObjectId } from \"mongodb\";\r\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\nconst API_KEY = process.env.GEMINI_API_KEY;\r\nconst genAI = API_KEY ? new GoogleGenerativeAI(API_KEY) : null;\r\n\r\n// GET ALL TASKS\r\nexport async function GET() {\r\n  try {\r\n    const client = await clientPromise;\r\n    const db = client.db(\"TodoDB\");\r\n\r\n    const tasks = await db.collection(\"tasks\").find({}).toArray();\r\n\r\n    return NextResponse.json(tasks);\r\n  } catch (error) {\r\n    return NextResponse.json({ error: error.message }, { status: 500 });\r\n  }\r\n}\r\n\r\n// ADD TASK WITH SUMMARY\r\nexport async function POST(request) {\r\n  try {\r\n    const { title, description = \"\" } = await request.json();\r\n\r\n    if (!title)\r\n      return NextResponse.json({ error: \"Title is required\" }, { status: 400 });\r\n\r\n    // --- Generate Summary (Gemini 2.5 Flash) ---\r\n    let summary = \"Summary not available\";\r\n    if (genAI) {\r\n      try {\r\n        const prompt = `\r\n          Generate a concise one-sentence summary for this task:\r\n          Title: \"${title}\"\r\n          Details: \"${description}\"\r\n        `;\r\n\r\n        const model = genAI.getGenerativeModel({ model: \"gemini-2.5-flash\" });\r\n        const result = await model.generateContent(prompt);\r\n        summary = result.response.text();\r\n      } catch (err) {\r\n        console.error(\"Gemini Error:\", err);\r\n      }\r\n    }\r\n\r\n    // --- Insert into MongoDB ---\r\n    const client = await clientPromise;\r\n    const db = client.db(\"TodoDB\");\r\n\r\n    const newTask = {\r\n      title,\r\n      description,\r\n      summary,\r\n      done: false,\r\n      createdAt: new Date(),\r\n    };\r\n\r\n    const result = await db.collection(\"tasks\").insertOne(newTask);\r\n\r\n    return NextResponse.json({ ...newTask, _id: result.insertedId });\r\n  } catch (error) {\r\n    return NextResponse.json({ error: error.message }, { status: 500 });\r\n  }\r\n}\r\n\r\n// UPDATE TASK (DONE)\r\nexport async function PUT(request) {\r\n  try {\r\n    const { id, done } = await request.json();\r\n\r\n    const client = await clientPromise;\r\n    const db = client.db(\"TodoDB\");\r\n\r\n    await db.collection(\"tasks\").updateOne(\r\n      { _id: new ObjectId(id) },\r\n      { $set: { done } }\r\n    );\r\n\r\n    return NextResponse.json({ success: true });\r\n  } catch (error) {\r\n    return NextResponse.json({ error: error.message }, { status: 500 });\r\n  }\r\n}\r\n\r\n// DELETE TASK\r\nexport async function DELETE(request) {\r\n  try {\r\n    const { id } = await request.json();\r\n\r\n    const client = await clientPromise;\r\n    const db = client.db(\"TodoDB\");\r\n\r\n    await db.collection(\"tasks\").deleteOne({ _id: new ObjectId(id) });\r\n\r\n    return NextResponse.json({ success: true });\r\n  } catch (error) {\r\n    return NextResponse.json({ error: error.message }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,UAAU,QAAQ,GAAG,CAAC,cAAc;AAC1C,MAAM,QAAQ,UAAU,IAAI,sLAAkB,CAAC,WAAW;AAGnD,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM,2HAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,MAAM,QAAQ,MAAM,GAAG,UAAU,CAAC,SAAS,IAAI,CAAC,CAAC,GAAG,OAAO;QAE3D,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF;AAGO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,cAAc,EAAE,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEtD,IAAI,CAAC,OACH,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAoB,GAAG;YAAE,QAAQ;QAAI;QAEzE,8CAA8C;QAC9C,IAAI,UAAU;QACd,IAAI,OAAO;YACT,IAAI;gBACF,MAAM,SAAS,CAAC;;kBAEN,EAAE,MAAM;oBACN,EAAE,YAAY;QAC1B,CAAC;gBAED,MAAM,QAAQ,MAAM,kBAAkB,CAAC;oBAAE,OAAO;gBAAmB;gBACnE,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;gBAC3C,UAAU,OAAO,QAAQ,CAAC,IAAI;YAChC,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,iBAAiB;YACjC;QACF;QAEA,8BAA8B;QAC9B,MAAM,SAAS,MAAM,2HAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,MAAM,UAAU;YACd;YACA;YACA;YACA,MAAM;YACN,WAAW,IAAI;QACjB;QAEA,MAAM,SAAS,MAAM,GAAG,UAAU,CAAC,SAAS,SAAS,CAAC;QAEtD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,GAAG,OAAO;YAAE,KAAK,OAAO,UAAU;QAAC;IAChE,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF;AAGO,eAAe,IAAI,OAAO;IAC/B,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEvC,MAAM,SAAS,MAAM,2HAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,MAAM,GAAG,UAAU,CAAC,SAAS,SAAS,CACpC;YAAE,KAAK,IAAI,mHAAQ,CAAC;QAAI,GACxB;YAAE,MAAM;gBAAE;YAAK;QAAE;QAGnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF;AAGO,eAAe,OAAO,OAAO;IAClC,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEjC,MAAM,SAAS,MAAM,2HAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,MAAM,GAAG,UAAU,CAAC,SAAS,SAAS,CAAC;YAAE,KAAK,IAAI,mHAAQ,CAAC;QAAI;QAE/D,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF"}}]
}